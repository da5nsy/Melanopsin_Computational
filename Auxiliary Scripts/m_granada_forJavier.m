clc, clear, close all

M=[390,0.0668000000000000;392,0.0808000000000000;394,0.0966000000000000;396,0.114100000000000;398,0.133400000000000;400,0.154100000000000;402,0.176400000000000;404,0.199800000000000;406,0.224300000000000;408,0.249600000000000;410,0.275500000000000;412,0.301700000000000;414,0.328100000000000;416,0.354300000000000;418,0.380300000000000;420,0.406000000000000;422,0.431000000000000;424,0.455000000000000;426,0.479000000000000;428,0.502000000000000;430,0.524000000000000;432,0.546000000000000;434,0.567000000000000;436,0.588000000000000;438,0.610000000000000;440,0.631000000000000;442,0.653000000000000;444,0.676000000000000;446,0.699000000000000;448,0.722000000000000;450,0.745000000000000;452,0.769000000000000;454,0.793000000000000;456,0.817000000000000;458,0.840000000000000;460,0.862000000000000;462,0.884000000000000;464,0.904000000000000;466,0.923000000000000;468,0.941000000000000;470,0.957000000000000;472,0.970000000000000;474,0.982000000000000;476,0.990000000000000;478,0.997000000000000;480,1;482,1;484,0.997000000000000;486,0.990000000000000;488,0.981000000000000;490,0.968000000000000;492,0.953000000000000;494,0.935000000000000;496,0.915000000000000;498,0.892000000000000;500,0.867000000000000;502,0.840000000000000;504,0.811000000000000;506,0.781000000000000;508,0.749000000000000;510,0.717000000000000;512,0.683000000000000;514,0.650000000000000;516,0.616000000000000;518,0.581000000000000;520,0.548000000000000;522,0.514000000000000;524,0.481000000000000;526,0.448000000000000;528,0.417000000000000;530,0.386400000000000;532,0.356900000000000;534,0.328800000000000;536,0.301800000000000;538,0.276200000000000;540,0.251900000000000;542,0.229100000000000;544,0.207600000000000;546,0.187600000000000;548,0.169000000000000;550,0.151700000000000;552,0.135800000000000;554,0.121200000000000;556,0.107800000000000;558,0.0956000000000000;560,0.0845000000000000;562,0.0745000000000000;564,0.0655000000000000;566,0.0574000000000000;568,0.0502000000000000;570,0.0438000000000000;572,0.0381600000000000;574,0.0331500000000000;576,0.0287400000000000;578,0.0248700000000000;580,0.0214700000000000;582,0.0185100000000000;584,0.0159300000000000;586,0.0136900000000000;588,0.0117500000000000;590,0.0100700000000000;592,0.00862000000000000;594,0.00737000000000000;596,0.00630000000000000;598,0.00538000000000000;600,0.00459000000000000;602,0.00391000000000000;604,0.00334000000000000;606,0.00284000000000000;608,0.00242000000000000;610,0.00206000000000000;612,0.00176000000000000;614,0.00150000000000000;616,0.00128000000000000;618,0.00109000000000000;620,0.000930000000000000;622,0.000790000000000000;624,0.000680000000000000;626,0.000580000000000000;628,0.000500000000000000;630,0.000430000000000000;632,0.000360000000000000;634,0.000310000000000000;636,0.000270000000000000;638,0.000230000000000000;640,0.000200000000000000;642,0.000170000000000000;644,0.000150000000000000;646,0.000130000000000000;648,0.000110000000000000;650,0.000100000000000000;652,8.00000000000000e-05;654,7.00000000000000e-05;656,6.00000000000000e-05;658,5.00000000000000e-05;660,5.00000000000000e-05;662,4.00000000000000e-05;664,4.00000000000000e-05;666,3.00000000000000e-05;668,3.00000000000000e-05;670,2.00000000000000e-05;672,2.00000000000000e-05;674,2.00000000000000e-05;676,2.00000000000000e-05;678,1.00000000000000e-05;680,1.00000000000000e-05;682,1.00000000000000e-05;684,1.00000000000000e-05;686,1.00000000000000e-05;688,1.00000000000000e-05;690,1.00000000000000e-05;692,1.00000000000000e-05;694,0;696,0;698,0;700,0;702,0;704,0;706,0;708,0;710,0;712,0;714,0;716,0;718,0;720,0;722,0;724,0;726,0;728,0;730,0];
%figure, plot(M(:,1),M(:,2));

load('C:\Users\cege-user\Dropbox\UCL\Data\Reference Data\Granada Data\Granada_daylight_2600_161.mat');
granada=final;
clear final
wavelength_granada=300:5:1100;

granada_norm=granada;

% %normalse data
% for i=1:2600
%     mx_g=max(granada(:,i));
%     granada_norm(:,i)=granada(:,i)./mx_g;
% end

M_wavelength=M(:,1);
M_int = interp1(M_wavelength,M(:,2),wavelength_granada);
M_int(isnan(M_int)) = 0.0;

granada_xy=zeros(3,length(granada));

for i=1:length(granada)  
    m = trapz(wavelength_granada,granada_norm(:,i)'.*M_int);
    granada_xy(3,i) = m;
end

figure('units','normalized','outerposition',[0 0 1 1])
axis([0 2600 0 180])
xlabel('dataset #') % x-axis label
ylabel('m value') % y-axis label
hold on
plot(1:2600,granada_xy(3,:),'o')